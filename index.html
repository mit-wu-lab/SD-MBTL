<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Structure Detection for Contextual Reinforcement Learning">
  <meta property="og:title" content="Structure Detection for Contextual Reinforcement Learning" />
  <meta property="og:description" content="Structure Detection for Contextual Reinforcement Learning" />
  <meta property="og:url" content="https://mit-wu-lab.github.io/SD-MBTL/" />
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/overview.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />


  <meta name="twitter:title" content="Structure Detection for Contextual Reinforcement Learning">
  <meta name="twitter:description" content="Structure Detection for Contextual Reinforcement Learning">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/overview.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="Structure Detection for Contextual Reinforcement Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Structure Detection for Contextual Reinforcement Learning</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
  <script>
    window.MathJax = {
      tex: {
        packages: {'[+]': ['ams']}
      },
      loader: {
        load: ['[tex]/ams']
      }
    };
  </script>
  <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>

<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Structure Detection for Contextual Reinforcement Learning
            </h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=GCeMu2MAAAAJ&hl=en" target="_blank">Tianyue Zhou*</a>,</span>
              <span class="author-block">
                <a href="https://www.junghooncho.com/" target="_blank">Jung-Hoon Cho*</a>,</span>
              <span class="author-block">
                <a href="https://www.wucathy.com/" target="_blank">Cathy Wu</a>
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">Massachusetts Institute of Technology<br>AAAI 2026</span>
              <span class="eql-cntrb"><small><br><sup>*</sup>Equal Contribution</small></span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">

                <!-- ArXiv abstract Link -->
                <!-- <span class="link-block">
                  <a href="https://arxiv.org/abs/2408.04498" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span> -->

                <!-- Poster PDF link -->
                <!-- <span class="link-block">
                  <a href="static/pdfs/2024-12-09 NeurIPS Poster MBTL.pdf" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Poster</span>
                  </a>
                </span> -->

                <!-- Github link -->
                <span class="link-block">
                  <!-- <a href="./" target="_blank" -->
                  <a href="https://github.com/mit-wu-lab/SD-MBTL" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- X.com link -->
                <!-- <span class="link-block">
                  <a href="https://x.com/wucathy/status/1865818430013587647" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon"> -->
                      <!-- <img src="https://x.com/favicon.ico" alt="X.com favicon" style="width: 1em; height: 1em;"> -->
                      <!-- <i class="fab fa-twitter"></i>
                    </span>
                    <span>Tweet</span>
                  </a> -->
                <!-- </span> -->

                <!-- News article link-->
                <!-- <span class="link-block">
                  <a href="https://news.mit.edu/2024/mit-researchers-develop-efficiency-training-more-reliable-ai-agents-1122" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <img src="https://sts-program.mit.edu/wp-content/uploads/2023/12/mit-favicon-white-on-black-512x512-1.png" alt="MIT news favicon" style="width: 1em; height: 1em;">
                    </span>
                    <span>MIT News</span>
                  </a>
                </span> -->

                <!-- Openreview link -->
                <!-- <span class="link-block">
                  <a href="https://openreview.net/forum?id=KLv1VLuMo8" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <img src="https://openreview.net/favicon.ico" alt="openreview favicon" style="width: 1em; height: 1em;">
                    </span>
                    <span>OpenReview</span>
                  </a>
                </span> -->

                <!-- MIT News link
                <span class="link-block">
                  <a href="https://news.mit.edu" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-newspaper"></i>
                    </span>
                    <span>MIT News</span>
                  </a>
                </span> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-4"><b>"MIT researchers develop an efficient approach for training more reliable reinforcement learning models, focusing on complex tasks that involve variability." (MIT News)</b></h2>
        </div>
      </div>
      </div>
    </div>
  </section> -->

  <!-- Teaser Image -->
  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <div class="has-text-centered">
          <img src="static/images/overview-sd-mbtl.png" alt="Teaser Image" class="teaser-image">
        </div>
        <h2 class="subtitle has-text-centered">
          <br>
          In this work, we introduce <b>Structure Detection MBTL (SD-MBTL)</b>, a generic framework that dynamically identifies the underlying generalization structure of CMDP and selects an appropriate MBTL algorithm.
        </h2>
      </div>
    </div>
  </section>


  <!-- Paper abstract -->
  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Contextual Reinforcement Learning (CRL) tackles the problem of solving a set of related Contextual Markov Decision Processes (CMDPs) that vary across different context variables. Traditional approaches---independent training and multi-task learning---struggle with either excessive computational costs or negative transfer. A recently proposed multi-policy approach, Model-Based Transfer Learning (MBTL), has demonstrated effectiveness by strategically selecting a few tasks to train and zero-shot transfer. However, CMDPs encompass a wide range of problems, exhibiting structural properties that vary from problem to problem. As such, different task selection strategies are suitable for different CMDPs. In this work, we introduce Structure Detection MBTL (SD-MBTL), a generic framework that dynamically identifies the underlying generalization structure of CMDP and selects an appropriate MBTL algorithm. For instance, we observe <span class="small-caps-text">Mountain</span> structure in which generalization performance degrades from the training performance of the target task as the context difference increases. We thus propose M/GP-MBTL, which detects the structure and adaptively switches between a Gaussian Process-based approach and a clustering-based approach. Extensive experiments on synthetic data and CRL benchmarks—covering continuous control, traffic control, and agricultural management—show that M/GP-MBTL surpasses the strongest prior method by 12.49% on the aggregated metric. These results highlight the promise of online structure detection for guiding source task selection in complex CRL environments.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- End paper abstract -->

  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-justified">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Structure Detection MBTL at a Glance</h2>
          <p>
            Real-world CRL deployments must juggle <em>families</em> of related tasks whose dynamics shift with payloads,
            weather, or traffic demand. Training a separate agent for every context wastes samples, yet a single
            multi-task policy often collapses under negative transfer once the context space grows. SD-MBTL instead asks
            whether the current CMDP exhibits a recognizable structure (e.g., the <span class="small-caps-text">Mountain</span>
            pattern where performance decays smoothly with context distance) and then picks the best source-task
            selection strategy on the fly. The rest of the page summarizes the math behind this detector and how it feeds
            into the training loop.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-justified">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Generalization-Performance Decomposition</h2>
          <div class="content">
            <p>
              For each source&ndash;target pair we split the transfer return into source quality, target difficulty, and
              dissimilarity:
            </p>
            <p class="has-text-centered">
              \[J(\pi_x, y) = f(x) + g(y) + h(x,y) + C.
              \]
            </p>
            <p>
              After training on contexts \(x_{1:k}\) we estimate target difficulty by subtracting the empirical mean over
              trained policies, \(\overline{J}(\pi_x,y) = J(\pi_x,y) - \mathbb{E}_{x' \in x_{1:k}}[J(\pi_{x'},y)]\), and
              apply two detection criteria:
            </p>
            <p class="has-text-centered">
              \[
              \texttt{Mountain} \Longleftrightarrow
              \begin{cases}
              \operatorname{std}_{x} \overline{J}(\pi_x,x) < \mathbb{E}_{x}\big[\operatorname{std}_{y} \overline{J}(\pi_x,y)\big], \\
              \text{sgn}(\theta_{\text{left}}^d) = \text{sgn}(\theta_{\text{right}}^d) \quad \forall d,
              \end{cases}
              \]
            </p>
            <p>
              where \(\theta_{\text{left/right}}^d\) are slopes from a linear regression on the signed L<sub>1</sub> context
              differences in dimension \(d\). Passing both tests means policy quality is almost constant and dissimilarity
              behaves like a distance metric, so the CMDP can be treated as <span class="small-caps-text">Mountain</span>. Otherwise training performance is
              heterogeneous and we rely on GP modeling.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <h2 class="title is-3">Detect &rarr; Select Loop</h2>
        <div class="columns is-centered">
          <div class="column">
            <p class="has-text-justified">
              <strong>Train:</strong> dedicate millions of PPO steps to one source context \(x_k\) to obtain a high-quality
              policy \(\pi_{x_k}\).
            </p>
          </div>
          <div class="column">
            <p class="has-text-justified">
              <strong>Evaluate:</strong> zero-shot transfer \(\pi_{x_k}\) to every target \(y\in Y\) to populate a new row of
              the transfer matrix.
            </p>
          </div>
          <div class="column">
            <p class="has-text-justified">
              <strong>Detect:</strong> update the statistics above, decide whether <span class="small-caps-text">Mountain</span> holds, and route training to the
              corresponding selector.
            </p>
          </div>
        </div>
        <div class="content has-text-justified">
          <p>
            Each iteration of SD-MBTL therefore looks like:
          </p>
          <ol>
            <li><strong>Update statistics.</strong> The fresh transfer row refines the estimates of \(f(x)\), \(g(y)\), and
              \(h(x,y)\), and we test the variance and slope criteria above.</li>
            <li><strong>Decide the structure.</strong> Passing both tests tags the CMDP as
              <span class="small-caps-text">Mountain</span>; otherwise we assume heterogeneous policy quality and lean on GP
              modeling.</li>
            <li><strong>Select the next task.</strong> We invoke the algorithm matched to the detected structure and add the
              chosen context to \(x_{1:k}\).</li>
          </ol>
          <p>
            When <span class="small-caps-text">Mountain</span> holds, greedy source-task selection reduces to a sequential
            clustering problem with L<sub>1</sub> loss:
          </p>
          <p class="has-text-centered">
            \[
            x_k = \arg\min_{x \in X} \mathbb{E}_{y \sim \mathcal{U}(Y)}\Big[\min_{x' \in x_{1:k-1} \cup \{x\}} \|x' - y\|_1\Big],
            \]
          </p>
          <p>
            and we solve it via a K-means style update plus random restarts (M-MBTL). Otherwise we choose GP-MBTL: a Gaussian
            process regresses \(J(\pi_x,x)\), the learned slopes \(\theta_{\text{left/right}}\) produce gap estimates, and an
            upper-confidence acquisition balances exploration and exploitation. Both branches reuse the same transfer data
            but embody different inductive biases, providing a principled Detect &rarr; Select loop.
          </p>
        </div>
        <div class="columns is-centered">
          <div class="column">
            <p><b>M-MBTL</b></p>
            <img src="static/images/M-MBTL.png" alt="M-MBTL" class="method-image">
          </div>
          <div class="column">
            <p><b>GP-MBTL</b></p>
            <img src="static/images/MBTL overview.gif" alt="GP-MBTL" class="method-image">
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <section class="section hero is-light">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-justified">
        <div class="column is-four-fifths">
          <h2 class="title is-3">M/GP-MBTL</h2>
          <img src="static/images/mgp-mbtl.png" alt="M/GP-MBTL" class="method-image">
        </div>
      </div>
    </div>
  </section>

    <section class="hero">
      <div class="container is-max-desktop">
        <div class="hero-body">
          <h2 class="title is-3">Benchmark Highlights</h2>
          <div class="columns is-multiline">
            <div class="column is-one-third">
              <div class="box has-text-centered">
                <div class="columns is-centered">
                  <div class="column is-half">
                    <img src="static/images/cartpole.gif" alt="CartPole" class="method-image">
                  </div>
                  <div class="column is-half">
                    <img src="static/images/bipedalwalker.gif" alt="BipedalWalker" class="method-image">
                  </div>
                </div>
                <p class="has-text-justified">
                  <strong>CartPole.</strong> Even on this easy CMDP, M/GP-MBTL keeps pace with the best multi-task policy
                  while training only a few experts.
                </p>
                <p class="has-text-justified">
                  <strong>BipedalWalker.</strong> <span class="small-caps-text">Mountain</span> structure dominates, so
                  M/GP-MBTL routes to M-MBTL and clearly outperforms both random and multi-task training.
                </p>
              </div>
            </div>
            <div class="column is-one-third">
              <div class="box has-text-centered">
                <img src="static/images/intersectionzoo.gif" alt="IntersectionZoo" class="method-image">
                <img src="static/images/intersectionzoo-logo.png" alt="IntersectionZoo logo" class="method-image">
                <p class="has-text-justified">
                  <strong>IntersectionZoo.</strong> Target-task difficulty varies sharply, so the detector prefers GP-MBTL,
                  yielding large gains over random or independent training while remaining competitive with the GP-only
                  variant.
                </p>
              </div>
            </div>
            <div class="column is-one-third">
              <div class="box has-text-centered">
                <img src="static/images/cyclesgym.png" alt="CyclesGym" class="method-image">
                <p class="has-text-justified">
                  <strong>CyclesGym.</strong> Another <span class="small-caps-text">Mountain</span> CMDP where clustering
                  excels; SD-MBTL mirrors the M-MBTL performance and surpasses independent as well as multi-task baselines.
                </p>
              </div>
            </div>
          </div>
          <div class="content has-text-justified">
            <p>
              After min-max normalizing each benchmark between the random policy and the myopic oracle, M/GP-MBTL improves
              the aggregated score by <strong>12.49%</strong> over the best prior MBTL method.
            </p>
            <img src="static/images/mgp-mbtl-result.png" alt="Aggregated results" class="method-image">
          </div>
        </div>
      </div>
    </section>



    <!-- Paper poster -->
    <!-- <section class="hero is-max-desktop is-light">
      <div class="hero-body">
        <div class="container">
          <h2 class="title">Poster</h2>
          <iframe src="static/pdfs/2024-12-09 NeurIPS Poster MBTL.pdf" width="100%" height="550">
          </iframe>

        </div>
      </div>
    </section> -->
    <!--End paper poster -->


    <!--BibTex citation -->
    <section class="section" id="BibTeX">
      <div class="container is-max-desktop content">
        <h2 class="title">BibTeX</h2>
        <pre><code>@inproceedings{zhou2026structure,
        title={Structure Detection for Contextual Reinforcement Learning},
        author={Zhou, Tianyue and Cho, Jung-Hoon and Wu, Cathy},
        booktitle={Proceedings of the AAAI Conference on Artificial Intelligence},
        year={2026}
      }</code></pre>
      </div>
    </section>
    <!--End BibTex citation -->


    <footer class="footer">
      <div class="container">
        <div class="columns is-centered">
          <div class="column is-8">
            <div class="content">

              <p>
                This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template"
                  target="_blank">Academic Project Page Template</a> which was adopted from the <a
                  href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
                You are free to borrow the source code of this website, we just ask that you link back to this page in
                the footer. <br> This website is licensed under a <a rel="license"
                  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
                  Commons Attribution-ShareAlike 4.0 International License</a>.
              </p>

            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Statcounter tracking code -->

    <!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

</body>

</html>
